"use strict";class BrightAISummarizer{constructor(t={}){this.config={apiEndpoint:"/api/ai/summary",buttonText:"تلخيص الصفحة",...t},this.isLoading=!1,this.init()}init(){this.createButton(),this.attachEvents()}createButton(){const t=document.createElement("button");t.id="ai-summarize-btn",t.className="ai-summary-btn glass-button",t.innerHTML=`<i class="fas fa-magic"></i> ${this.config.buttonText}`,t.setAttribute("aria-label","استخدم الذكاء الاصطناعي لتلخيص محتوى هذه الصفحة"),t.style.position="fixed",t.style.bottom="100px",t.style.left="20px",t.style.zIndex="900",t.style.display="flex",t.style.alignItems="center",t.style.gap="8px",document.body.appendChild(t),this.button=t}attachEvents(){this.button.addEventListener("click",()=>this.generateSummary())}async generateSummary(){if(!this.isLoading){this.setLoading(!0);try{const t=document.querySelector("main")?.innerText||document.body.innerText,e=await fetch(this.config.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})}),n=await e.json();if(!e.ok)throw new Error(n.error||"Failed to summarize");this.showModal(n.summary)}catch(t){console.error("Summary error:",t),alert("عذراً، حدث خطأ أثناء التلخيص.")}finally{this.setLoading(!1)}}}setLoading(t){this.isLoading=t,this.button.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> جاري التلخيص...':`<i class="fas fa-magic"></i> ${this.config.buttonText}`,this.button.disabled=t}showModal(t){const e=document.createElement("div");e.className="modal active",e.innerHTML=`\n            <div class="modal-header">\n                <h2>ملخص الصفحة (AI)</h2>\n                <button class="modal-close"><i class="fas fa-times"></i></button>\n            </div>\n            <div class="modal-body">\n                ${t.replace(/\n/g,"<br>")}\n            </div>\n        `;const n=document.createElement("div");n.className="modal-backdrop active",document.body.appendChild(n),document.body.appendChild(e);const i=()=>{e.remove(),n.remove()};e.querySelector(".modal-close").addEventListener("click",i),n.addEventListener("click",i)}}document.addEventListener("DOMContentLoaded",()=>{document.body.innerText.length>1e3&&new BrightAISummarizer});