"use strict";const debounce=(e,t)=>{let a;return function(...r){const i=this;clearTimeout(a),a=setTimeout(()=>e.apply(i,r),t)}},throttle=(e,t)=>{let a=!1;return function(...r){const i=this;a||(e.apply(i,r),a=!0,setTimeout(()=>a=!1,t))}},escapeHtml=e=>{if("string"!=typeof e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML},isInViewport=(e,t=0)=>{const a=e.getBoundingClientRect(),r=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth,o=a.top<=r*(1-t)&&a.top+a.height>=r*t,n=a.left<=i*(1-t)&&a.left+a.width>=i*t;return o&&n},generateId=(e="id")=>`${e}_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,initDataLayer=()=>{window.dataLayer=window.dataLayer||[]},pushDataLayerEvent=(e,t={},a=!1)=>{initDataLayer();const r={event:e,...t};window.dataLayer.push(r)},getFromStorage=(e,t=null)=>{try{const a=localStorage.getItem(e);return a?JSON.parse(a):t}catch(e){return console.warn("[BrightAI Utils] localStorage read error:",e),t}},setToStorage=(e,t)=>{try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){return console.warn("[BrightAI Utils] localStorage write error:",e),!1}},formatTimeArabic=e=>{if(e<60)return e+" ثانية";if(e<3600){return Math.floor(e/60)+" دقيقة "+e%60+" ثانية"}return Math.floor(e/3600)+" ساعة "+Math.floor(e%3600/60)+" دقيقة"},formatDateArabic=e=>e.toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),formatTimeLocale=e=>e.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),DEFAULT_FALLBACK_IMAGE="Gemini.png",handleImageError=(e,t="Gemini.png")=>{if(!e||e.dataset.fallbackApplied)return;e.dataset.fallbackApplied="true";const a=window.location.pathname;let r=t;(a.includes("/blogger/")||a.includes("/Customer/")||a.includes("/Docfile/")||a.includes("/botAI/"))&&(r="../"+t),e.src=r,e.alt=e.alt||"صورة بديلة",e.style.opacity="0.9"},initImageErrorHandlers=(e="img",t="Gemini.png")=>{document.querySelectorAll(e).forEach(e=>{if(e.onerror||e.dataset.errorHandled)return;const a=e.src||e.getAttribute("src")||"";(a.startsWith("http://")||a.startsWith("https://"))&&(e.dataset.errorHandled="true",e.onerror=function(){handleImageError(this,t)},e.complete&&0===e.naturalWidth&&handleImageError(e,t))})},createImageWithFallback=(e,t,a={})=>{const r=document.createElement("img");r.src=e,r.alt=t,a.className&&(r.className=a.className),a.width&&(r.width=a.width),a.height&&(r.height=a.height),a.loading&&(r.loading=a.loading);const i=a.fallbackSrc||"Gemini.png";return r.onerror=function(){handleImageError(this,i)},r},isValidSaudiPhone=e=>/^(05\d{8}|5\d{8}|\+9665\d{8}|009665\d{8})$/.test(e),isValidEmail=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);window.BrightAIUtils={debounce:debounce,throttle:throttle,escapeHtml:escapeHtml,isInViewport:isInViewport,generateId:generateId,initDataLayer:initDataLayer,pushDataLayerEvent:pushDataLayerEvent,getFromStorage:getFromStorage,setToStorage:setToStorage,formatTimeArabic:formatTimeArabic,formatDateArabic:formatDateArabic,formatTimeLocale:formatTimeLocale,handleImageError:handleImageError,initImageErrorHandlers:initImageErrorHandlers,createImageWithFallback:createImageWithFallback,DEFAULT_FALLBACK_IMAGE:"Gemini.png",isValidSaudiPhone:isValidSaudiPhone,isValidEmail:isValidEmail},"undefined"!=typeof module&&module.exports&&(module.exports={debounce:debounce,throttle:throttle,escapeHtml:escapeHtml,isInViewport:isInViewport,generateId:generateId,initDataLayer:initDataLayer,pushDataLayerEvent:pushDataLayerEvent,getFromStorage:getFromStorage,setToStorage:setToStorage,formatTimeArabic:formatTimeArabic,formatDateArabic:formatDateArabic,formatTimeLocale:formatTimeLocale,handleImageError:handleImageError,initImageErrorHandlers:initImageErrorHandlers,createImageWithFallback:createImageWithFallback,DEFAULT_FALLBACK_IMAGE:"Gemini.png",isValidSaudiPhone:isValidSaudiPhone,isValidEmail:isValidEmail});